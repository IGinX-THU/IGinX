#
# IGinX - the polystore system with high performance
# Copyright (C) Tsinghua University
# TSIGinX@gmail.com
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with this program; if not, write to the Free Software Foundation,
# Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
#

####################
### ????
####################
# iginx ??? ip
ip=0.0.0.0

# iginx ?????
port=6888

# iginx ??????
username=root

# iginx ?????
password=root

##########################
### ?????
##########################

# ????????','??????
#storageEngineList=127.0.0.1#6667#iotdb12#username=root#password=root#sessionPoolSize=20#has_data=false#is_read_only=false
#storageEngineList=127.0.0.1#8086#influxdb#url=http://localhost:8086/#token=your-token#organization=your-organization#has_data=false
storageEngineList=127.0.0.1#6668#filesystem#iginx_port=6888#has_data=false#is_read_only=false#dir=data#data.config.write.buffer.size=104857600#data.config.write.buffer.timeout=1s#dummy_dir=dummy#dummy.struct=LegacyFilesystem#dummy.config.chunk_size_in_bytes=1048576#dummy.config.memory_pool_size=100#client.connectPool.maxTotal=100
#storageEngineList=127.0.0.1#5432#relational#engine=postgresql#username=postgres#password=postgres#has_data=false
#storageEngineList=127.0.0.1#3306#relational#engine=mysql#username=root#has_data=false
#storageEngineList=127.0.0.1#27017#mongodb#uri="mongodb://127.0.0.1:27017/?maxPoolSize=200&maxIdleTimeMS=60000&waitQueueTimeoutMS=50000"#has_data=false#schema.sample.size=1000#dummy.sample.size=0
#storageEngineList=127.0.0.1#6379#redis#has_data=false#is_read_only=false#timeout=20000#data_db=1#dummy_db=0
#storageEngineList=127.0.0.1#19530#VectorDB#protocol=grpc#has_data=false#is_read_only=false#timeout=5000#topk=3
#storageEngineList=127.0.0.1#1521#relational#engine=oracle#username=system#password=Oracle123#has_data=false

# ???????
databaseClassNames=iotdb12=cn.edu.tsinghua.iginx.iotdb.IoTDBStorage,influxdb=cn.edu.tsinghua.iginx.influxdb.InfluxDBStorage,filesystem=cn.edu.tsinghua.iginx.filesystem.FileSystemStorage,relational=cn.edu.tsinghua.iginx.relational.RelationalStorage,mongodb=cn.edu.tsinghua.iginx.mongodb.MongoDBStorage,redis=cn.edu.tsinghua.iginx.redis.RedisStorage,vectordb=cn.edu.tsinghua.iginx.vectordb.MilvusStorage

##########################
### ????
##########################

# ???????
replicaNum=0

# ????
policyClassName=cn.edu.tsinghua.iginx.policy.naive.NaivePolicy
#policyClassName=cn.edu.tsinghua.iginx.policy.simple.SimplePolicy

# ???????????????????????
reshardFragmentTimeMargin=60

##########################
### ??????
##########################

#???????
# statisticsCollectorClassName=cn.edu.tsinghua.iginx.statistics.StatisticsCollector

# ?????????????
# statisticsLogInterval=5000

##########################
### Session ??
##########################

# thrift?????????
minThriftWorkerThreadNum = 20

# thrift?????????
maxThriftWrokerThreadNum = 2147483647

##########################
### ?????
##########################

# ??
constraintChecker=naive

# ???????
queryOptimizer=rbo

# ?????
ruleBasedOptimizer=NotFilterRemoveRule=on,ColumnPruningRule=on,ConstantPropagationRule=on,DistinctEliminateRule=on,\
  ConstantFoldingRule=on,FilterPushDownRule=on,JoinFactorizationRule=on,SetTransformPushDownPathUnionJoinRule=on,InFilterTransformRule=on,\
  OuterJoinEliminateRule=on

#ruleBasedOptimizer=AllowNullColumnRule=on

##########################
### ?????
##########################

# ?????????
memoryTaskThreadPoolSize=200

# ??????????????
physicalTaskThreadPoolSizePerStorage=100

# ?????????????
maxCachedPhysicalTaskPerStorage=500

# ???????
physicalOptimizer=naive

enablePushDown=true

useStreamExecutor=false

# ParallelFilter????
parallelFilterThreshold=10000
# ParallelGroupBy????
parallelGroupByRowsThreshold=10000
# ParallelApplyFunc?????
parallelApplyFuncGroupsThreshold=1000
# ParallelGroupBy?????
parallelGroupByPoolSize=5
# ParallelGroupBy?????
parallelGroupByPoolNum=5
# ParallelGroupBy?????
streamParallelGroupByWorkerNum=5

####################
### Migration ????
####################

# ????????????
migrationBatchSize=100

# ????????????????????
maxReshardFragmentsNum=3

# ?????????????????????????????
maxTimeseriesLoadBalanceThreshold=2

# ??????
#migrationPolicyClassName=cn.edu.tsinghua.iginx.migration.SimulationBasedMigrationPolicy
migrationPolicyClassName=cn.edu.tsinghua.iginx.migration.GreedyMigrationPolicy

##########################
### ??????
##########################

# ????????
enableMonitor=false

# ?????????????: s?
loadBalanceCheckInterval=3

# ????????
enableFragmentCompaction=false

# ????????????????????????????
fragmentCompactionWriteThreshold=1000

# ?????????????????????????
fragmentCompactionReadThreshold=1000

# ???????????????????????????
fragmentCompactionReadRatioThreshold=0.1

####################
### ?????
####################

# ???? zookeeper, etcd
# ???????????????
metaStorage=zookeeper

# ???? zookeeper ??????????????
zookeeperConnectionString=127.0.0.1:2181

# ???? etcd ???????????????????? etcd ????????
#etcdEndpoints=http://localhost:2379

# ???????????
enableMetaCacheControl=false

# ?????????????? KB??? 128 MB
fragmentCacheThreshold=131072

##########################
### ????
##########################

enableMemoryControl=false

systemResourceMetrics=default

heapMemoryThreshold=0.9

systemMemoryThreshold=0.9

systemCpuThreshold=0.9

####################
### REST ????
####################

# rest ??? ip
restIp=0.0.0.0

# rest ?????
restPort=7888

# ???? rest ??
enableRestService=true

# ???? margin, ????
disorderMargin=10

# rest ???????
asyncRestThreadPool=100

##########################
### Python??
##########################
# python??????
# ?Windows???python3??python
# pythonCMD=python
# ?unix??????"which python"?????????????
#pythonCMD=/Library/Frameworks/Python.framework/Versions/3.7/bin/python3
pythonCMD=python3

# ?????????????UDF/Transform
needInitBasicUDFFunctions=false

# UDF???????????????????????????????????
# %defaultUDFDir%
#   |- udf_list         (udf??????????)
#   |- python_scripts/   (python?????)
#       |- xxx.py       (python??)
defaultUDFDir=udf_funcs

##########################
### Transform??
##########################
# ?????????????
batchSize=50
# Transform???????
transformTaskThreadPoolSize=10
# Transform??????
transformMaxRetryTimes=3

# ?????yaml???????
defaultScheduledTransformJobDir=transform_jobs

####################
### MQTT ??
####################

enableMqtt=false

mqttHost=0.0.0.0

mqttPort=1883

mqttHandlerPoolSize=1

mqttPayloadFormatter=cn.edu.tsinghua.iginx.mqtt.JsonPayloadFormatter

mqttMaxMessageSize=1048576

##########################
### SimplePolicy ????
##########################

reAllocatePeriod=300000

enableStorageGroupValueLimit=true

storageGroupValueLimit=200.0

# ??????????????
enableEnvParameter=false

#################
### ??????
#################

# ??csv???????????
batchSizeImportCsv=10000
